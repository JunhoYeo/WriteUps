#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import os, urllib.request
from pwn import *
e = ELF('./flag')
del(e)
os.system('upx -d flag')
log.info('Unpacked ./flag')
e = ELF('./flag')
main_addr = e.symbols[b'main']
log.info("function main at : " + hex(main_addr))
log.info(disasm(e.read(main_addr, 60)))
rodata_addr = e.get_section_by_name('.rodata').header.sh_addr
flag = e.read(rodata_addr, 49).decode()
log.info('FLAG : ' + flag[8:])
