#!/usr/bin/env python2
# -*- coding: utf-8 -*-
from pwn import *
shell = ssh('random', 'pwnable.kr', password='guest', port=2222) # make ssh connection
shell.download_file('./random') # download binary file
shell.download_file('./random.c') # download binary source code
random = 0x6b8b4567 # random value
log.info('random : ' + str(random))
key = random ^ 0xdeadbeef # calculate key
log.info('key : ' + str(key))
sh = shell.run('./random')
sh.sendline(str(key)) 
print sh.recvline()
log.info('FLAG : ' + sh.recvline())
