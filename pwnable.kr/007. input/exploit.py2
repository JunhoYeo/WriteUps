#!/usr/bin/env python2
# -*- coding: utf-8 -*-
from pwn import *
import random
argv = [str(0) for i in range(100)]
argv[ord('A')] = '\x00'; argv[ord('B')] = '\x20\x0a\x0d' # 1
open('./stderr', 'w').write('\x00\x0a\x02\xff') # 2
env = {'\xde\xad\xbe\xef':'\xca\xfe\xba\xbe'} # 3
open('./\x0a', 'w').write('\x00\x00\x00\x00') # 4
port = str(randint(1000, 99999))
argv[ord('C')] = port # 5
p = process(
    executable='/home/input2/input', 
    argv=argv, env=env,
    stderr=open('./stderr')
)
p.sendline('\x00\x0a\x00\xff') # 2
r = remote('localhost', port)
r.send('\xde\xad\xbe\xef')
print p.recvall()
